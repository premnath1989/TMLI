<!DOCTYPE html>
<html>
    <head>
        <!--<link href="SI/css/style.css" rel="stylesheet" type="text/css" />-->
        <script type="text/javascript" charset="utf-8" src="SI/js/jquery-1.8.2.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="SI/js/hla.js"></script>
        <style>
            #maincontainer
            {
                top:0px;
                padding-top:0;
                margin:auto;
                width:100%;
                height:100%;
            }
            thead,table-Summary1 {
                border: 1px solid black;
            }
        thead,table-Summary2 {
            border: 1px solid black;
        }
        /*td {
            border-style: solid;
            border-color: black;
            border-width: 0px;
            padding: 0px 0px 0px 0px;
            text-align: justify;
            font-size:10px;
            font-family: "Helvetica"
        }*/
        td.cellCenter3 {
            text-align: center;
            border-style: solid;
            border-color: black;
            border-width: 1px;
        }
        td.cellRight3 {
            text-align: right;
            border-style: solid;
            border-color: black;
            border-width: 1px;
        }
        p {
            font-size:10px;
            padding: 0px 0px 0px 0px;
        }
        z {
            font-size:10px;
            padding: 0px 0px 0px 0px;
        }
        header1 {
            font-size:18px;
            padding: 0px 0px 0px 0px;
        }
        footer1 {
            width:100%;
            position: absolute;
            bottom: 0;
            left: 0;
        }
        tr.rowStyle {
            border-style: solid;
            border-color: black;
            border-width: 1px;
            font-size:10px;
            
        }
        </style>
        
        
			<script>
                var lastCol1;
                var lastCol3;
                var lastCol51 = 0 ;
                var dictBasicPlan;
                var dictPOLAData;
                var dictFundAllocationData;
                var dictRiderData;
                var dictTopUpWithDrawData;
                
                //1. Loyalty Bonus (PY,ProductCode)
                var arrLoyaltyBonus;
                //2. RegPremAllo (PY,ProductCode)
                var arrRegPremAllo;
                //3. PremTopUpAll (PY,ProductCode)
                var arrPremTopUpAll;
                //4. COI (Age,Gender)
                var arrCOI;
                //5. PolicyAdmin (PY,ProductCode)
                var arrPolicyAdmin;
                //6. ServiceCharge (PY,ProductCode)
                var arrServiceCharge;
                //7. PremiumHolidayCharge (PY,ProductCode)
                var arrPermiumHolidayCharge;
                //9. WithDrawalChargeRate (PY,ProductCode)
                var arrWithdrawalChargeRate;
                //10. ScheduleWithdrawalRate (Age,ProductCode)
                var arrScheduleWithdrawalRate;
                //11. SurrenderChargeRate (PY,ProductCode)
                var arrSurrenderChargeRate;
                //12. Juvenile (AgeFrom,AgeTo,Rate)
                var arrJuvenileRate;
                //13. Adv_MediCare (Age_band,PlanCode) ambil semua kolom
                var arrAdvMedicareRate;
                //14. CI55_Rate (Age,Gender)
                var arrCI55;
                //15. CI_Early_Rate (Age,Gender)
                var arrCIEE;
                //16. CashPlan_Rate (Age,Gender)
                var arrCashPlan;
                //17. HSR_COR (Age,PlanCode) ambil semua kolom
                var arrHSRCOR;
                //18. HSR_Factor (PY,HSR_Factor)
                var arrHSRFactor;

                function getMOPValue(){
                    var retMOP;
                    var rawMOP = dictBasicPlan.Payment_Frequency;
                    if (rawMOP == "Tahunan"){
                        retMOP = 1;
                    }
                    else if (rawMOP == "Semester"){
                        retMOP = 2;
                    }
                    else if (rawMOP == "Kuartal"){
                        retMOP = 4;
                    }
                    else if (rawMOP == "Bulanan"){
                        retMOP = 12;
                    }
                    return retMOP;
                }
            
                function toTitleCase(str)
                {
                    return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
                }
            
                function getCol4(Col1){
                    var retCol4;
                    var premTerm = dictBasicPlan.Payment_Term;
                    if (Col1 > premTerm){
                        retCol4 = 0;
                    }
                    else{
                        retCol4 = 1;
                    }
                    return retCol4;
                }
            
                function getCol5(Col2){
                    var retCol5;
                    var paymentFreq = dictBasicPlan.Payment_Frequency;
                    if (paymentFreq == "Tahunan"){
                        if (Col2 == 1){
                            retCol5 = 1;
                        }
                        else{
                            retCol5 = 0;
                        }
                    }
                    else if (paymentFreq == "Semester"){
                        if (Col2 == 1 || Col2 == 7){
                            retCol5 = 1;
                        }
                        else{
                            retCol5 = 0;
                        }
                    }
                    else if (paymentFreq == "Kuartal"){
                        if (Col2 == 1 || Col2 == 4 || Col2 == 7 || Col2 == 10){
                            retCol5 = 1;
                        }
                        else{
                            retCol5 = 0;
                        }
                    }
                    else if (paymentFreq == "Bulanan"){
                        if (Col2 >= 1 && Col2 <= 12){
                            retCol5 = 1;
                        }
                        else{
                            retCol5 = 0;
                        }
                    }
                    return retCol5;
                }
            
                function getCol6(Col1,Col4,Col5){
                    var retCol6;
                    var premTerm = dictBasicPlan.Payment_Term;
                    var regularPremium = dictBasicPlan.Premium.replace(/\D/g,'');
                    if (premTerm >= Col1){
                        retCol6 = parseInt(regularPremium) * Col4 * Col5;
                    }
                    else{
                        retCol6 = 0;
                    }
                    return retCol6;
                }

                function getCol7(Col1,Col4,Col5){
                    var retCol7;
                    var premTerm = dictBasicPlan.Payment_Term;
                    var regularTopUp = dictBasicPlan.RegularTopUp.replace(/\D/g,'');
                    if (premTerm >= Col1){
                        retCol7 = parseInt(regularTopUp) * Col4 * Col5;
                    }
                    else{
                        retCol7 = 0;
                    }
                    return retCol7;
                }
            
                function getCol8(Col1){
                    var retCol8;
                    var premTerm = dictBasicPlan.Payment_Term;
                    var regularPremium = dictBasicPlan.Premium.replace(/\D/g,'');
                    if (Col1 > premTerm){
                        retCol8 = 0;
                    }
                    else{
                        retCol8 = regularPremium;
                    }
                    return retCol8;
                }
            
                function getCol9(Col1){
                    var retCol9;
                    var productCode = "\"" + dictPOLAData.ProductCode + "\"";
                    var mop = getMOPValue();
                    var regularPremium = dictBasicPlan.Premium.replace(/\D/g,'');
                    var arrayRateLoyalty = arrLoyaltyBonus.arrLoyaltyBonus;
                    var dictRateLoyalty = arrayRateLoyalty.filter(FilterArrayDictByPolisYear);
                    var rateLoyalty = dictRateLoyalty[0][productCode];
                    
                    retCol9 = parseInt(rateLoyalty)/100 * parseInt(regularPremium) * mop;
                    return retCol9;
                }
            
                function getCol10(Col1,Col5,Col6){
                    var retCol10;
                    var productCode = "\"" + dictPOLAData.ProductCode + "\"";
                    var arrayRatePremAllo = arrRegPremAllo.arrRegPremAllo;
                    var dictRatePremAllo = arrayRatePremAllo.filter(FilterArrayDictByPolisYear);
                    var ratePremAllo = dictRatePremAllo[0][productCode];
                    
                    retCol10 = parseInt(ratePremAllo)/100 * parseInt(Col5) * parseInt(Col6);
                    return retCol10;
                }
            
                function getCol11(Col1,Col5,Col7,Col8){
                    var retCol11;
                    var productCode = "\"" + dictPOLAData.ProductCode + "\"";
                    var arrayRatePremTopUpAll = arrPremTopUpAll.arrPremTopUpAll;
                    var dictRatePremTopUpAll = arrayRatePremTopUpAll.filter(FilterArrayDictByPolisYear);
                    var ratePremTopUpAll = dictRatePremTopUpAll[0][productCode];
                    
                    retCol11 = parseInt(ratePremTopUpAll)/100 * (parseInt(Col7) + parseInt(Col8)) * parseInt(Col5);
                    return retCol11;
                }
            
                function getCol12(){
                    var retCol12;
                    var laGender = toTitleCase(dictPOLAData.LA_Gender);
                    var arrayRateCOI = arrCOI.arrCOI;
                    var dictRateCOI = arrayRateCOI.filter(FilterArrayDictByAgeGender);
                    var rateCOI = dictRateCOI[0][laGender];
                    var basicSumAssured = dictBasicPlan.SumAssured.replace(/\D/g,'');
                    var extraPremiMil = dictBasicPlan.ExtraPremiumMil;
                    retCol12 = rateCOI/1000 * 0.0833 * parseInt(basicSumAssured) + (parseInt(extraPremiMil) * parseInt(basicSumAssured)/1000 * 0.0833);
                    return retCol12;
                }
            
                function getCol13(){
                    var retCol13;
                    var productCode = "\"" + dictPOLAData.ProductCode + "\"";
                    var arrayRatePolicyAdmin = arrPolicyAdmin.arrPolicyAdmin;
                    var dictRatePolicyAdmin = arrayRatePolicyAdmin.filter(FilterArrayDictByPolisYear);
                    var ratePolicyAdmin = dictRatePolicyAdmin[0][productCode];
                    
                    retCol13 = parseInt(ratePolicyAdmin);
                    return retCol13;
                }
            
                function getCol14(Col10){
                    var retCol14;
                    
                    retCol14 = lastCol51 + parseInt(Col10);
                    return retCol14;
                }
            
                function getCol15(Col14){
                    var retCol15;
                    var productCode = "\"" + dictPOLAData.ProductCode + "\"";
                    var mop = getMOPValue();
                    var regularPremium = dictBasicPlan.Premium.replace(/\D/g,'');
                    var arrayRateServiceCharge = arrServiceCharge.arrServiceCharge;
                    var dictRateServiceCharge = arrayRateServiceCharge.filter(FilterArrayDictByPolisYear);
                    var rateServiceCharge = dictRateServiceCharge[0][productCode];
                    if ( dictPOLAData.ProductCode == "3BE"){
                        retCol15 = parseFloat(rateServiceCharge)/100 * parseInt(regularPremium) * parseInt(mop);
                    }
                    else{
                        retCol15 = parseFloat(rateServiceCharge)/100 * parseInt(Col14) / 12;
                    }
                    return retCol15;
                }
            
                function getCol16(){
                    var retCol16;
                    var basicSumAssured = dictBasicPlan.SumAssured.replace(/\D/g,'');
                    var extraPremiMil = dictBasicPlan.ExtraPremiumMil;
                    retCol16 = Math.min(parseInt(basicSumAssured),2000000000);
                    return retCol16;
                }
            
                function getCol17(Col1,Col16){
                    var retCol17;
                    var extraPremiPercent = dictBasicPlan.ExtraPremiumMil;
                    var premTerm = dictBasicPlan.Payment_Term;
                    if (Col1 <= premTerm){
                        retCol17 = 0.98 * (1 + parseInt(extraPremiPercent)) * Col16/1000 * 0.0833;
                    }
                    else{
                        retCol17 = 0;
                    }
                    return retCol17;
                }
            
                function FilterArrayDictByPolisYear(arrayData) {
                    return arrayData.PY == lastCol1;
                }
            
                function FilterArrayDictByAgeGender(arrayData) {
                    return arrayData.Age == lastCol3;
                }
            
                function CreateTableBenefitProjection(){
                    var laAge = dictPOLAData.LA_Age;
                    var basicTerm = 99 - parseInt(laAge);
                    for (var i=1;i<=basicTerm;i++){
                        var col1 = i;
                        lastCol1 = col1;
                        var col2 = 1;
                        var col3 = parseInt(laAge) + parseInt((col1-1));
                        
                        lastCol3 = col3;
                        var col4 = getCol4(col1);
                        var col5 = getCol5(col2);
                        var col6 = getCol6(col1,col4,col5);
                        var col7 = getCol7(col1,col4,col5);
                        var col8 = getCol8(col1);
                        var col9 = getCol9(col1);
                        var col10 = getCol10(col1,col5,col6);
                        var col11 = getCol11(col1,col5,col7,col8);
                        var col12 = getCol12();
                        var col13 = getCol13();
                        var col14 = getCol14(col10);
                        var col15 = getCol15(col14);
                        var col16 = getCol16();
                        var col17 = getCol17(col1,col16);
                        
                    }
                }
            </script>
            <!--<body onload="onBodyLoad()">-->
            <body>
				
				<div id="maincontainer">
				<div class="main-content">
					
                    <table id="TableBenefitIllustration" cellspacing="0" cellpadding="2" width="100%">
                        <tr>
                            <td colspan="9"  >F. Tabel Ilustrasi Proyeksi Nilai Investasi dan Manfaat Meninggal - Semua Jenis Investasi</td>
                            <td colspan="2" align="right" >dalam Rupiah (000)</td>
                        </tr>
                        <tr>
                            <th rowspan="2" align = "center" style="border: 1px solid black" width="5%">Akhir <br>Tahun</th>
                            <th rowspan="2" align = "center" style="border: 1px solid black" width="5%">Usia</th>
                            <th colspan="3" align = "center" style="border: 1px solid black" width="30%">Proyeksi Nilai Manfaat 1)</th>
                            <th colspan="3" align = "center" style="border: 1px solid black" width="30%">Proyeksi Manfaat Meninggal Dunia 2</th>
                            <th colspan="3" align = "center" style="border: 1px solid black" width="30%">Proyeksi Manfaat Nilai Tebus 3)</th>
                        </tr>
                        <tr>
                            <td align = "center" style="border: 1px solid black" width="10%">Rendah</td>
                            <td align = "center" style="border: 1px solid black" width="10%">Sedang</td>
                            <td align = "center" style="border: 1px solid black" width="10%">Tinggi</td>
                            <td align = "center" style="border: 1px solid black" width="10%">Rendah</td>
                            <td align = "center" style="border: 1px solid black" width="10%">Sedang</td>
                            <td align = "center" style="border: 1px solid black" width="10%">Tinggi</td>
                            <td align = "center" style="border: 1px solid black" width="10%">Rendah</td>
                            <td align = "center" style="border: 1px solid black" width="10%">Sedang</td>
                            <td align = "center" style="border: 1px solid black" width="10%">Tinggi</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </table>
					
				</div>
				</div>
				
                <br/>
                <br/>
                <br/>
                <br/>
            </body>
    </head>        
</html>
